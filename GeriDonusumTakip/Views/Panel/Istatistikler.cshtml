@model IstatistikViewModel
@{
    ViewData["Title"] = "Ä°statistikler";
    Layout = "_PanelLayout";
}

<div class="stats-container">
    <!-- Ã–zet KartlarÄ± -->
    <div class="stats-summary">
        <div class="stat-card">
            <span class="stat-icon">ğŸ“Š</span>
            <h4>Toplam KayÄ±t</h4>
            <p>@Model.ToplamKayit adet</p>
        </div>

        <div class="stat-card">
            <span class="stat-icon">âš–ï¸</span>
            <h4>Toplam Miktar</h4>
            <p>@Model.ToplamMiktar.ToString("N1") kg</p>
        </div>

        <div class="stat-card">
            <span class="stat-icon">ğŸŒ³</span>
            <h4>KurtarÄ±lan AÄŸaÃ§</h4>
            <p>@Model.KurtarilanAgac.ToString("N1") adet</p>
        </div>

        <div class="stat-card">
            <span class="stat-icon">ğŸ’§</span>
            <h4>Su Tasarrufu</h4>
            <p>@Model.TasarrufEdilenSu.ToString("N0") Lt</p>
        </div>

        <div class="stat-card">
            <span class="stat-icon">âš¡</span>
            <h4>Enerji Tasarrufu</h4>
            <p>@Model.TasarrufEdilenEnerji.ToString("N1") kWh</p>
        </div>

        <div class="stat-card">
            <span class="stat-icon">ğŸŒ</span>
            <h4>Ã–nlenen CO2</h4>
            <p>@Model.OnlenenEmisyon.ToString("N1") kg</p>
        </div>
    </div>

    <!-- TÃ¼r BazlÄ± Ä°statistikler -->
    <div class="stats-section">
        <h3>â™»ï¸ TÃ¼r BazlÄ± DaÄŸÄ±lÄ±m</h3>
        <div class="stats-chart">
            @if (Model.TurBazliDagilim.Any())
            {
                foreach (var tur in Model.TurBazliDagilim)
                {
                    var yuzde = Model.ToplamMiktar > 0 ? (tur.Value / Model.ToplamMiktar) * 100 : 0;
                    <div class="chart-item">
                        <div class="chart-label">
                            <span>@tur.Key</span>
                            <span>@tur.Value.ToString("N1") kg</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: @yuzde%"></div>
                        </div>
                    </div>
                }
            }
            else
            {
                <div class="no-data-message">
                    <span>ğŸ“Š</span>
                    <p>HenÃ¼z tÃ¼r bazlÄ± veri bulunmuyor.</p>
                </div>
            }
        </div>
    </div>

    <!-- AylÄ±k Ä°statistikler -->
    <div class="stats-section">
        <h3>ğŸŒ TÃ¼r BazlÄ± Ã‡evresel Etki</h3>
        <div class="impact-grid">
            <div class="impact-card">
                <h4>KaÄŸÄ±t</h4>
                <div class="impact-stats">
                    <span>ğŸŒ³ @Model.KagitEtki.Agac.ToString("N1") aÄŸaÃ§</span>
                    <span>ğŸ’§ @Model.KagitEtki.Su.ToString("N0") Lt</span>
                    <span>âš¡ @Model.KagitEtki.Enerji.ToString("N1") kWh</span>
                </div>
            </div>
            <div class="impact-card">
                <h4>Plastik</h4>
                <div class="impact-stats">
                    <span>ğŸ’§ @Model.PlastikEtki.Su.ToString("N0") Lt</span>
                    <span>âš¡ @Model.PlastikEtki.Enerji.ToString("N1") kWh</span>
                    <span>ğŸŒ @Model.PlastikEtki.Emisyon.ToString("N1") kg CO2</span>
                </div>
            </div>
            <div class="impact-card">
                <h4>Cam</h4>
                <div class="impact-stats">
                    <span>ğŸ’§ @Model.CamEtki.Su.ToString("N0") Lt</span>
                    <span>âš¡ @Model.CamEtki.Enerji.ToString("N1") kWh</span>
                    <span>ğŸŒ @Model.CamEtki.Emisyon.ToString("N1") kg CO2</span>
                </div>
            </div>
            <div class="impact-card">
                <h4>Metal</h4>
                <div class="impact-stats">
                    <span>ğŸ’§ @Model.MetalEtki.Su.ToString("N0") Lt</span>
                    <span>âš¡ @Model.MetalEtki.Enerji.ToString("N1") kWh</span>
                    <span>ğŸŒ @Model.MetalEtki.Emisyon.ToString("N1") kg CO2</span>
                </div>
            </div>
        </div>
    </div>

    <div class="stats-section">
        <h3>ğŸ¯ YÄ±llÄ±k Hedefler</h3>
        <div class="goals-grid">
            <div class="goal-card">
                <h4>Toplam Geri DÃ¶nÃ¼ÅŸÃ¼m</h4>
                <div class="progress-circle" data-progress="@Model.YillikHedefYuzdesi">
                    <span>@Model.ToplamMiktar.ToString("N0") / 1000 kg</span>
                </div>
            </div>
            <div class="goal-card">
                <h4>KurtarÄ±lan AÄŸaÃ§</h4>
                <div class="progress-circle" data-progress="@Model.AgacHedefYuzdesi">
                    <span>@Model.KurtarilanAgac.ToString("N0") / 100 adet</span>
                </div>
            </div>
            
        </div>
    </div>

    <div class="stats-section">
        <h3>ğŸ“ˆ Ã‡evresel Etki GeliÅŸimi</h3>
        <div class="timeline">
            @foreach (var etki in Model.EtkiGelisimi)
            {
                <div class="timeline-item">
                    <div class="timeline-date">@etki.Tarih.ToString("MMM yyyy")</div>
                    <div class="timeline-content">
                        <p>ğŸŒ³ @etki.KurtarilanAgac aÄŸaÃ§</p>
                        <p>ğŸ’§ @etki.TasarrufEdilenSu Lt su</p>
                        <p>âš¡ @etki.TasarrufEdilenEnerji kWh</p>
                    </div>
                </div>
            }
        </div>
    </div>

    <div class="stats-section">
        <h3>ğŸ¯ KiÅŸisel Hedeflerim</h3>
        
        <!-- Hedef Ekleme Formu -->
        <form asp-action="HedefEkle" method="post" class="hedef-form">
            <select name="HedefTuru" required>
                <option value="Kagit">KaÄŸÄ±t</option>
                <option value="Plastik">Plastik</option>
                <option value="Cam">Cam</option>
                <option value="Metal">Metal</option>
            </select>
            <input type="number" name="HedefMiktar" placeholder="Hedef Miktar (kg)" required>
            <input type="date" name="BitisTarihi" required>
            <button type="submit">Hedef Ekle</button>
        </form>

        <!-- Aktif Hedefler -->
        <div class="hedefler-grid">
            @foreach (var hedef in Model.AktifHedefler)
            {
                <div class="hedef-card">
                    <h4>@hedef.Hedef.HedefTuru</h4>
                    <div class="hedef-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: @hedef.TamamlanmaYuzdesi%"></div>
                        </div>
                        <span>@hedef.GuncelMiktar.ToString("N1") / @hedef.Hedef.HedefMiktar kg</span>
                    </div>
                    <p>@hedef.KalanGun gÃ¼n kaldÄ±</p>
                    <form asp-action="HedefSil" method="post">
                        <input type="hidden" name="id" value="@hedef.Hedef.Id">
                        <button type="submit">Hedefi Sil</button>
                    </form>
                </div>
            }
        </div>
    </div>
</div> 

